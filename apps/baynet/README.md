# Baynet - Bayesian Networks

We will leverage the pgmpy Python library, which supports the construction of Dynamic Bayesian Networks (DBNs). Since microservice interactions in distributed systems are highly dynamic, our architecture will reflect that by allowing the Bayesian network's values and weights to adapt based on real-time events.

Below, we outline how the system's dynamics will operate:


![stats](images/baynet.png)


## Baynet Architecture Overview

1. Anomaly Detection via LLM
A JSON payload containing anomaly-related data (e.g., service name, event type, timestamp) will be generated by a Large Language Model (LLM) whenever anomalies are detected during training. These events will be sent to an AWS SQS queue for asynchronous processing.

2. Trace Analysis
Upon receiving an anomaly event, Baynet will focus analysis on traces specifically related to the affected microservice(s). Only the services identified as anomalous will be processed in this step, ensuring efficient root cause detection.

3. Dynamic Weight Adjustment
Using insights from the trace data—such as span errors and performance degradation—the Bayesian network’s edge weights will be updated to reflect current conditions and inferred causal relationships.

4. Relationship Mapping
Component relationships, which may evolve over time, are dynamically identified using data from Istio. This allows Baynet to build an accurate and current representation of the microservices communication graph.

Ultimately, Baynet will perform real-time Bayesian inference, dynamically adapting to the ever-changing nature of distributed systems to deliver precise and timely insights.




## Endpoints

[Bayesian Networks](structe_plot.html) 

```bash
https://maia-lasdpc.icmc.usp.br/baynet
```

```bash
https://maia-lasdpc.icmc.usp.br/kiali
```

![stats](images/kiali.png)


[Istio Dashboard](https://grafana-lasdpc.icmc.usp.br/d/b5ee5ce8-c0fe-4bd8-a4c9-4230885558e0/istio-service-dashboard?orgId=1&refresh=1m&var-datasource=prometheus&var-service=payment.sock-shop.svc.cluster.local&var-qrep=source&var-qrep=destination&var-srccluster=All&var-srcns=All&var-srcwl=All&var-dstcluster=All&var-dstns=All&var-dstwl=All&from=now-1h&to=now)
